import{k as y,u as S,a8 as E,_ as j,j as e,g as f,a1 as N,r as g,i as x}from"./index-CTXLcj4T.js";import{u as q}from"./index.esm-Df70vtWG.js";import{a as v,I as w}from"./Input-2BG84v2a.js";import{F as m}from"./FormRow-D5XxLNeK.js";import{F}from"./FormRowButtons-CCSOGa_m.js";import{F as P}from"./FileInput-BW7ruGCu.js";import{R as b}from"./Row-DJ7VZngJ.js";function U(){const u=y(),{mutate:t,isPending:o}=S({mutationFn:({password:n,fullName:l,avatar:s})=>E({password:n,fullName:l,avatar:s}),onSuccess:()=>{j.success("Current user updated successfully"),u.invalidateQueries({queryKey:["user"]})},onError:()=>j.error("Somthing went wrong")});return{updateUser:t,isUpdating:o}}function W(){var c,h;const{register:u,handleSubmit:t,formState:o,getValues:n,reset:l}=q(),{errors:s}=o,{updateUser:p,isUpdating:a}=U();function d({password:i}){p({password:i},{onSuccess:l})}return e.jsxs(v,{onSubmit:t(d),children:[e.jsx(m,{label:"New password (min 8 characters, contains special chars & numbers)",error:(c=s==null?void 0:s.password)==null?void 0:c.message,withError:!0,children:e.jsx(w,{$full:!0,type:"password",id:"password",autoComplete:"current-password",disabled:a,...u("password",{required:"This feild is required",minLength:{value:8,message:"Password must be a miniumum of 8 characters"},pattern:{value:/(\W+\d+\w*|\d+\W+\w*|\W+\w*\d+|\d+\w*\W+|\w*\W+\d+|\w*\d+\W+)/,message:"password should contain special character and numbers"},validate:i=>{if(i.includes(" "))return"Password shouldn't contain a space"}})})}),e.jsx(m,{label:"Confirm password",error:(h=s==null?void 0:s.passwordConfirm)==null?void 0:h.message,withError:!0,children:e.jsx(w,{$full:!0,type:"password",autoComplete:"new-password",id:"passwordConfirm",disabled:a,...u("passwordConfirm",{required:"This field is required",validate:i=>n().password===i||"Passwords need to match"})})}),e.jsxs(F,{children:[e.jsx(f,{onClick:l,type:"reset",$variation:"secondary",children:"Cancel"}),e.jsx(f,{disabled:a,children:"Update password"})]})]})}function R(){const{user:{email:u,user_metadata:{fullName:t}}}=N(),{updateUser:o,isUpdating:n}=U(),[l,s]=g.useState(t),[p,a]=g.useState(""),[d,c]=g.useState(null);function h(r){if(r.preventDefault(),l===t&&d===null){a("Please change the full name at least");return}p===""&&o({fullName:l,avatar:d})}function i(r){r.target.value.length?r.target.value===t&&d===null?a("Please change the full name at least"):r.target.value.trim().split(" ").length>2?a("Full name should contain one space"):r.target.value.trim().length>20?a("Full name should be less or equle 20 characters"):a(""):a("Full name can't be empty"),s(r.target.value)}function C(){s(t),c(null)}return e.jsxs(v,{onSubmit:h,children:[e.jsx(m,{label:"Email address",children:e.jsx(w,{value:u,disabled:!0})}),e.jsx(m,{label:"Full name",withError:!0,error:p,children:e.jsx(w,{$full:!0,type:"text",value:l,onChange:i,id:"fullName",disabled:n})}),e.jsx(m,{label:"Avatar image",children:e.jsx(P,{id:"avatar",accept:"image/*",onChange:r=>c(r.target.files[0]),disabled:n})}),e.jsxs(F,{children:[e.jsx(f,{type:"reset",$variation:"secondary",disabled:n,onClick:C,children:"Cancel"}),e.jsx(f,{disabled:n,children:"Update account"})]})]})}function Q(){return e.jsxs(e.Fragment,{children:[e.jsx(x,{as:"h1",children:"Update your account"}),e.jsxs(b,{children:[e.jsx(x,{as:"h3",children:"Update user data"}),e.jsx(R,{})]}),e.jsxs(b,{children:[e.jsx(x,{as:"h3",children:"Update password"}),e.jsx(W,{})]})]})}export{Q as default};
