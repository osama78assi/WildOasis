import{k as A,u as L,_ as v,a as B,r as y,j as e,L as T,M as c,z as k,A as I,o as N,m as W,p as $,h as H,i as F}from"./index-C7b2bvWS.js";import{u as q,E as z,R as Q}from"./ErrorMsg-C4x-XTqp.js";import{u as Z}from"./useCabins-Dyq4dHmF.js";import{E as K,C as M,S as a}from"./SortBy-B2Hx7D3F.js";import{T as g}from"./Table-D1loitRD.js";import{u as U,C as _}from"./CreateCabinForm-CWP8YAXg.js";import{d as G}from"./apiCabins-B-fWmTHZ.js";import{f as E}from"./helpers-Bi0Ndbns.js";import{M as h,C as J}from"./ConfirmDelete-CmDyar1d.js";import{I as V}from"./Img-CShqMSru.js";import{R as w}from"./Row-P49_eTiD.js";import{F as j}from"./Filter-D1h4WJit.js";import"./index.esm-Bgpo_ddD.js";import"./FileInput-iN0OM-cp.js";import"./Input-D61ntdOD.js";import"./FormRow-DHhgwMt4.js";import"./Textarea-DiNGiqY5.js";import"./FormRowButtons-qEhoA5HI.js";function X(){const n=A(),{isPending:t,mutate:i}=L({mutationFn:G,onSuccess:()=>{v.success("Cabin Deleted Successfuly"),n.invalidateQueries({queryKey:["cabin"]})},onError:r=>v.error(r)});return{isPending:t,deleteCabinFn:i}}const Y=B.div`
  font-size: 1.6rem;
  font-weight: 600;
  color: var(--color-grey-600);
  font-family: "Sono";
`,D=B.div`
  font-family: "Sono";
  font-weight: 500;
  color: var(--color-green-700);
`,ee=B.div`
  font-family: "Sono";
  font-weight: 600;
`,te=`
@media (max-width: 920px) {
  & {
    grid-template-rows: 10rem;
  }
}
`;function ne({cabin:n,position:t}){const{id:i,name:r,maxCapacity:s,regularPrice:f,discount:l,image:o,description:d}=n,[m,C]=y.useState(""),{isPending:u,deleteCabinFn:x}=X(),{isCreating:b,create:p}=U(),O=b||u;function R(){p({newCabinData:{name:`Copy of ${r}`,maxCapacity:s,regularPrice:f,discount:l,image:o,description:d},copy:!0})}return y.useEffect(()=>{fetch(o,{method:"GET"}).then(S=>S.blob()).then(S=>{const P=URL.createObjectURL(S);C(P)})},[o]),e.jsxs(g.Row,{additionStyles:te,children:[m?e.jsx(V,{src:m}):e.jsx(T,{additionalStyle:{height:"140px"}}),e.jsx(Y,{children:r}),e.jsxs("div",{children:["Fits up to ",s," guests"]}),e.jsx(ee,{children:E(f)}),l?e.jsx(D,{children:E(l)}):e.jsx(D,{style:{textAlign:"center"},children:"â€”"}),e.jsx("div",{children:e.jsxs(h,{children:[e.jsxs(c,{id:i,children:[e.jsx(c.Toggle,{disabled:O}),e.jsxs(c.List,{position:t,children:[e.jsx(c.Button,{Icon:k,onClick:R,children:"Dublicate"}),e.jsx(h.Open,{opens:"edit",children:e.jsx(c.Button,{Icon:I,children:"Edit"})}),e.jsx(h.Open,{opens:"delete",children:e.jsx(c.Button,{Icon:N,children:"Delete"})})]})]}),e.jsx(h.Window,{name:"edit",form:!0,children:e.jsx(_,{cabinToEdit:n})}),e.jsx(h.Window,{name:"delete",popup:!0,children:e.jsx(J,{resourceName:`cabin ${r}`,disabled:u,onConfirm:()=>x(i)})})]})})]})}function ie(n,t){return t=="all"?n:t=="with-discount"?n.filter(i=>i.discount>0):t=="no-discount"?n.filter(i=>i.discount==0):n}function re(n,t,i){return t==="name"&&i==1?n.sort((r,s)=>s.name.localeCompare(r.name)):t==="name"&&i==-1?n.sort((r,s)=>r.name.localeCompare(s.name)):t?n.sort((r,s)=>(s[t]-r[t])*i):n}function se(){var u;const{isFetching:n,cabins:t,error:i}=Z(),[r]=W(),{isFetching:s,reFetch:f}=q();if(n)return e.jsx($,{});if(i)return v.error("Cabins coudln't be loaded",{duration:5e3}),e.jsx(z,{faildFor:"cabins",queryKey:["cabin"]});if(!t.length)return e.jsx(K,{resource:"Cabins"});const l=r.get("discount")||"all";let o=ie(t,l);const d=((u=r.get("cabin-sort"))==null?void 0:u.split("-"))||[],m=d[0]||"",C=d[1]=="asc"||d[1]==""?1:-1;return o=re(o,m,C),e.jsxs(g,{columns:"2.5fr 1fr 1.1fr 1fr 1fr 1fr",smColumns:"2fr 1fr 1.1fr 1fr 1fr 1fr",children:[e.jsxs(g.Header,{children:[e.jsx("div",{}),e.jsx("div",{children:"Cabin"}),e.jsx("div",{children:"Capacity"}),e.jsx("div",{children:"Price"}),e.jsx("div",{children:"Discount"}),e.jsx(Q,{isFetching:s,disabled:s,onClick:f})]}),e.jsx(g.Body,{data:o,render:(x,b,p)=>e.jsx(ne,{cabin:x,position:p.length==1?"center-left":b==p.length-1?"top-left":"bottom-left"},x.id)})]})}function oe(){const[n,t]=y.useState("h2");return H(500,()=>t("h3"),()=>t("h2")),e.jsxs(w,{$type:"vertical",style:{gap:"1rem",overflow:"unset"},children:[e.jsxs(M,{children:[e.jsx(F,{as:n,children:"Filter"}),e.jsxs(j,{filterFor:"discount",collapseAt:600,defaultFilter:"all",children:[e.jsx(j.FilterButton,{filter:"all",children:"All"}),e.jsx(j.FilterButton,{filter:"no-discount",children:"Without discount"}),e.jsx(j.FilterButton,{filter:"with-discount",children:"With discount"})]})]}),e.jsxs(M,{children:[e.jsx(F,{as:n,$txt:"left",children:"Sort"}),e.jsxs(a,{sortFor:"cabin-sort",type:"white",getMinAt:600,activeLable:"By name (A-Z)",children:[e.jsx(a.SelectOption,{value:"name-asc",children:"By name (A-Z)"}),e.jsx(a.SelectOption,{value:"name-desc",children:"By name (Z-A)"}),e.jsx(a.SelectOption,{value:"regularPrice-asc",children:"By price (high first)"}),e.jsx(a.SelectOption,{value:"regularPrice-desc",children:"By price (low first)"}),e.jsx(a.SelectOption,{value:"maxCapacity-asc",children:"By capacity (high first)"}),e.jsx(a.SelectOption,{value:"maxCapacity-desc",children:"By capacity (low first)"})]})]})]})}function we(){const[n,t]=y.useState("h1");return H(500,()=>t("h2"),()=>t("h1")),e.jsxs(e.Fragment,{children:[e.jsxs(w,{$type:"horizontal",style:{overflow:"unset"},children:[e.jsx(F,{as:n,children:"All cabins"}),e.jsx(oe,{})]}),e.jsx(w,{style:{height:"46rem"},children:e.jsx(se,{})})]})}export{we as default};
